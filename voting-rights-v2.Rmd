---
title: "voting-rights-v2"
author: "margaret"
date: "3/30/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r library, message=F}
library(tidyverse)
library(janitor)
library(scales)
```

data from: https://dl.ncsbe.gov/index.html?prefix=data/Snapshots/

```{r load-data}
durham21 <- read_csv("data/duke_2021.csv")
```


```{r find-students}
duke_students <- durham21 %>%
  filter(
    street_name %in% c("DUKE UNIVERSITY WEST CAMPUS", 
                       "DUKE UNIVERSITY EAST CAMPUS", "TOWERVIEW", "ALEXANDER", 
                       "YEARBY") |
      (street_name %in% c("BASSETT", "EPWORTH", "FEW QUAD", "GILBERT ADDOMS", 
                          "GILES", "JARVIS", "MAXWELL", "MIRECOURT", "PEGRAM", 
                          "RANDOLPH", "RANDOLPH HALL", "ROUND TABLE", 
                          "SOUTHGATE", "WAYNE MANOR", "WILSON", "WANNAMAKER") && 
         street_type_cd == "DORM") |
      (street_name == "SWIFT" & house_num == "300") |
      (street_name == "CAMPUS"  & str_detect(house_num, "13\\d\\d"))
  )
```

```{r}
duke_students %>%
  filter(age < 50) %>%
  mutate(registr_yr = lubridate::year(registr_dt)) %>%
  count(registr_yr) %>%
  filter(registr_yr >= 2000) %>%
  ggplot(aes(x = registr_yr, y = n)) +
  geom_line() +
  geom_line(
    data = duke_students %>%
  filter(age < 50) %>%
  mutate(registr_yr = lubridate::year(registr_dt)) %>%
  count(registr_yr) %>%
  filter(registr_yr %in% c(2004, 2008, 2012, 2016, 2020)),
  color = "red"
  ) +
  geom_point(
    data = duke_students %>%
  filter(age < 50) %>%
  mutate(registr_yr = lubridate::year(registr_dt)) %>%
  count(registr_yr) %>%
  filter(registr_yr %in% c(2004, 2008, 2012, 2016, 2020)),
  color = "red",
  size = 3
  ) +
  scale_y_continuous(labels = scales::label_comma()) +
  labs(
    x = "Year",
    y = "Number of Duke students registered"
  ) +
  theme_minimal()
```

```{r}
durham21 %>%
  count(street_name, street_type_cd) %>%
  arrange(desc(n))

durham21 %>%
  count(ncid) %>%
  arrange(desc(n))
```



